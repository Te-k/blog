<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Google Advanced Protection | </title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="">
  <meta name="keywords" content="google , security">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Google Advanced Protection" />
  <meta name="twitter:description" content=""
  />
  <meta name="twitter:site" content="@https://twitter.com/tenacioustek" />
  <meta name="twitter:creator" content="@https://twitter.com/tenacioustek" />
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />

  
  
    
 
  
  

  

  
    
    <link rel="stylesheet" href="/css/post.min.b55e48a57c205580facfa82070761940c943e10b594ebdb023151ba0ff1d16cc.css" integrity="sha256-tV5IpXwgVYD6z6ggcHYZQMlD4QtZTr2wIxUboP8dFsw="/>
  
    
    <link rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa&#43;/TImW&#43;5JCeuQeRkm5NMpJWZG3hSuFU="/>
  

  
   
    

<script type="application/ld+json">
  
    { 
      "@context": "http://schema.org", 
      "@type": "WebSite", 
      "url": "https:\/\/randhome.io\/blog\/2017\/11\/05\/google-advanced-protection\/",
      "name": "Google Advanced Protection",
      "author": {
        "@type": "Person",
        "name": ""
      },
      "description": ""
    }
  
  </script>
</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>


  <nav class="nav" role="navigation">
  <ul class="nav__list">
    
    
      <li>
          
          
        <a  href="/">home</a>
      </li>
    
      <li>
          
          
        <a  class="active" href="/post/">blog</a>
      </li>
    
      <li>
          
          
        <a  href="/projects/">projects</a>
      </li>
    
      <li>
          
          
        <a  href="/resources/">resources</a>
      </li>
    
      <li>
          
          
        <a  href="/about/">about</a>
      </li>
    
      <li>
          
          
        <a  href="/contact/">contact</a>
      </li>
    
    <li></li>
    <li>
        
        EN
        
        
        
            <a href="/fr" lang="fr" class="no-translation">FR</a>
        
        
    </li>
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">Google Advanced Protection</h1>
            <time datetime="2017-11-05 00:00:42 -0400 -0400" class="post__date">5 Nov 2017   &middot; 7 minutes read </time>
          </header>
          <article class="post__content">
              
<p>Last week, Google has added a new set of security features in Gmail called <a href="https://landing.google.com/advancedprotection/">&ldquo;Advanced Protection&rdquo;</a>, specifically for high-risk users. It was widely covered the media (<a href="https://www.wired.com/story/google-advanced-protection-locks-down-accounts/">Wired</a>, <a href="https://www.theverge.com/2017/10/17/16488572/google-advanced-protection-phishing-fraud-security-keys">The Verge</a> or <a href="https://www.reuters.com/article/us-google-cyber/google-launches-advanced-gmail-security-features-for-high-risk-users-idUSKBN1CM1GP">Reuters</a>) and quickly started a debate about whether Google is <a href="https://motherboard.vice.com/en_us/article/kz74ym/google-gmail-advanced-protection-security-keys-yubikey">the most secure email provider on the planet</a> or if <a href="https://motherboard.vice.com/en_us/article/pa3ye7/protonmail-gmail-security-comparison">ProtonMail can compete</a>. The main point here to me (and it has been said by many other people everywhere) is whether you trust Google to keep your data or not, depending on your threat model and your opinion about privacy.</p>
<p>But it does not mean we should not understand what Google proposes to  do here. This blog post intends to detail these security features and test them.</p>
<h1 id="google-advanced-protection">Google Advanced Protection</h1>
<p>Here is what Google includes in the Advanced Protection (according to the <a href="https://landing.google.com/advancedprotection/">Google page</a> and <a href="https://www.wired.com/story/google-advanced-protection-locks-down-accounts/">Wired</a>):</p>
<ul>
<li>Log in on Desktop only with a 2 factor authentication USB device</li>
<li>Log in on smartphone only with a 2 factor authentication Bluetooth device</li>
<li>Blocking non-Google apps from accessing Gmail or Google Drive data</li>
<li>Google malware scanner will do more in depth analysis and detection</li>
<li>If you loose access to your account, you will have extra steps to recover access to it</li>
</ul>
<h3 id="usb-universal-2-factor-authentication-on-desktop">USB Universal 2 Factor Authentication on Desktop<a class="anchor" href="#usb-universal-2-factor-authentication-on-desktop">#</a></h3>
<p>With Advanced Protection, authentication on your Google account will only be possible with an USB key as second factor (i.e. in addition to your password). These devices have been more and more common for the past years following the development of the Universal 2 Factor Authentication (U2F) standard which allowed different manufacturers to develop such products. This type of second factor is much more secure than text messages (which can be read or stolen either by exploiting issues <a href="https://www.wired.com/2017/05/fix-ss7-two-factor-authentication-bank-accounts/">in the phone network</a>, or by abusing <a href="https://techcrunch.com/2016/06/10/how-activist-deray-mckessons-twitter-account-was-hacked/">your phone provider</a>) and apps on your phone (which are good but can still be abused by compromising your phone).</p>
<p>You can find the list of 2Fa dongles <a href="http://www.dongleauth.info/dongles/">here</a>, the most common being <a href="https://www.yubico.com/products/yubikey-hardware/fido-u2f-security-key/">the Yubikey</a> which costs around 18USD.</p>
<figure>
    <img src="/media/advancedprotection/yubikey.png" style="max-width:200px"/>
   
    <center>
        <small><i>
        Yubikey U2F device
        
            
        
            </i></small> 
    </center>
    
</figure>

<p>U2F USB dongles are now accepted by many platforms (Github, Dropbox, Facebook&hellip; you can find the list <a href="http://www.dongleauth.info/">here</a>). You can use them with Chrome and Opera too. Firefox will support it <a href="https://www.yubico.com/2017/09/firefox-nightly-enables-support-fido-u2f-security-keys/">soon</a>- there is an <a href="https://addons.mozilla.org/en-US/firefox/addon/u2f-support-add-on/">extension</a> for it but I could not make it work on my laptop.</p>
<h3 id="bluetooth-u2f-dongle">Bluetooth U2F Dongle<a class="anchor" href="#bluetooth-u2f-dongle">#</a></h3>
<p>As USB devices are not an option for smartphones, the solution is to use a Bluetooth U2F dongle. For now, Google proposes to use the <a href="https://www.ftsafe.com/products/FIDO/Multi">Security Key made by Feitian</a> (you can find it on <a href="https://www.amazon.com/Feitian-MultiPass-FIDO-Security-Key/dp/B01LYV6TQM">Amazon</a> for ~25USD)</p>
<figure>
    <img src="/media/advancedprotection/feitiankey.jpg" style="max-width:200px"/>
   
    <center>
        <small><i>
        Feitian Bluetooth/NFC U2F key
        
            
        
            </i></small> 
    </center>
    
</figure>

<h3 id="blocking-non-google-apps">Blocking Non-Google apps<a class="anchor" href="#blocking-non-google-apps">#</a></h3>
<p>To me, that&rsquo;s one of the main benefit of Advanced Protection. Standard Google accounts allows external applications to access Gmail/Google Drive data through the OAuth2 protocol. You see this feature in many websites who use your gmail account for authentication, but it can also be used to request full access to your emails and data. This feature became largely known in May when <a href="https://www.wired.com/2017/05/dont-open-google-doc-unless-youre-positive-legit/">a large phishing campaign</a> used this trick to propagate to victim&rsquo;s contacts, but we knew <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks/">since April</a> that this feature had been used in <a href="https://attack.mitre.org/wiki/Group/G0007">APT28</a> phishing campaigns.</p>
<figure><img src="/media/advancedprotection/oauth.jpg" width="700"/><figcaption>
            <h4>Example of an OAuth app requesting full access to emails (Source: TrendMicro)</h4>
        </figcaption>
</figure>

<p>Google also allows you to define application passwords, which are passwords you can use for specific applications to access your emails without second factor (commonly used for Thunderbird/Outlook).</p>
<p>The drawback of this protection is that many third party apps will be blocked. According to <a href="https://landing.google.com/advancedprotection/">Google</a>, it is only possible to access Gmail through your browser (no Outlook or Thunderbird), and Apple apps on iOS (Mail, Contact and Calendar) won&rsquo;t work. You will have to use Google apps.</p>
<h3 id="google-malware-scanner">Google Malware Scanner<a class="anchor" href="#google-malware-scanner">#</a></h3>
<p>This feature is not clear to me. Google mentions where they use this (in May <a href="https://www.blog.google/products/g-suite/keeping-your-company-data-safe-new-security-updates-gmail/">they published </a> about how they now use machine learning for malware detection in GSuite for instance), but not really on how they implement it.</p>
<p>According to <a href="https://www.wired.com/story/google-advanced-protection-locks-down-accounts/">Wired</a>, this feature would delay email reception by more than 60 seconds. My guess is that either they use dynamic analysis on attached files for malware detection, or they request the content of links included in emails to check for malicious pages (which seems more likely as this feature was added in GSuite <a href="https://gsuiteupdates.googleblog.com/2017/05/early-detection-of-phishing-via-delayed-delivery.html">recently</a>).</p>
<h3 id="extra-steps-for-account-recovery">Extra Steps for Account Recovery<a class="anchor" href="#extra-steps-for-account-recovery">#</a></h3>
<p>The implementation of this feature is not clear either. <a href="https://landing.google.com/advancedprotection/">Google</a> explains that <em>&ldquo;Advanced Protection adds extra steps to verify your identity. If you ever lose access to your account and both of your Security Keys, these added verification requirements will take a few days to restore access to your account&rdquo;</em>. For now, Google uses different methods to confirms that you are the owner of an account (any 2FA you could have, recovery address and also the creation date of the account or a secret question). It is unclear to me what changes in this process (and Google likely won&rsquo;t communicate about it).</p>
<h1 id="step-by-step-guide">Step by Step Guide</h1>
<p>So let&rsquo;s do this. First go on the Advanced Protection page : <a href="https://landing.google.com/advancedprotection/">https://landing.google.com/advancedprotection/</a></p>
<figure><img src="/media/advancedprotection/start.png" width="600"/>
</figure>

<p>Google asks confirmation that you own both U2F devices, or proposes to buy <a href="https://www.amazon.com/Feitian-MultiPass-FIDO-Security-Key/dp/B01LYV6TQM">this one</a> and <a href="https://www.amazon.com/Yubico-Y-123-FIDO-U2F-Security/dp/B00NLKA0D8">this one</a>. I only have USB devices for know but it should be enough for tests.</p>
<figure><img src="/media/advancedprotection/step1.png" width="600"/>
</figure>

<p>Then it requires you to install 2 security keys :</p>
<figure><img src="/media/advancedprotection/step2.png" width="600"/>
</figure>

<p>As I don&rsquo;t have a bluetooth dongle yet, I am adding two test YubiKeys</p>
<figure><img src="/media/advancedprotection/step3.png" width="600"/>
</figure>

<p>Last confirmation:
<figure><img src="/media/advancedprotection/step4.png" width="600"/>
</figure>
</p>
<p>Success!</p>
<figure><img src="/media/advancedprotection/success.png"/>
</figure>

<h1 id="tests">Tests</h1>
<p>Let&rsquo;s first test the delays due to the malware scan:</p>
<ul>
<li>For text only emails, I have not seen any delay at all</li>
<li>For links, I have not experienced any delay (but it may be because they were already known by Google)</li>
<li>For an attached file (I tried with a doc), it was delayed around 2 minutes</li>
</ul>
<p>Next let’s test access to Gmail and Gdrive, I have used the <a href="https://developers.google.com/oauthplayground/">OAuth playground</a> to try OAuth2 access :</p>
<ul>
<li>I was able to access calendar and contact information</li>
<li>both Gmail and Gdrive were indeed blocked :</li>
</ul>
<p><img src="/media/advancedprotection/nope.png" alt="Nope"></p>
<p>Finally, I tested Application Passwords. Application passwords are just not available anymore in the interface.</p>
<p>I tried to recover the account by giving the creation date and an unrelated email but I got this question :</p>
<p><img src="/media/advancedprotection/test.png" alt="Test"></p>
<p>It does not seem to be different to me from a standard account, but Google may have different processes for the manual background checks, hard to know.</p>
<h1 id="conclusion">Conclusion</h1>
<p>Besides the recurrent is-Google-in-your-threat-model question, I find these features interesting as it clearly increases the security of your account (especially for app specific access which is more and more used in phishing attacks). But as John-Scott Railton <a href="https://www.johnscottrailton.com/security-for-the-high-risk-user/">has rightly argued</a>, <strong>security features are not efficient if they are intended for high-risk users only and disabled by default</strong>. Some people will indeed be ready to take time and accept usability tradeoffs to increase their security level, but it is likely that a majority of high-risk users won&rsquo;t take such steps for thousands of different and legitimate reasons (from a lack of time, to a real need to use some softwares). Or even more likely: they don&rsquo;t consider themselves as high-risk users (many activists are not aware of these risks).</p>
<p><strong>Google should invest time and effort into bringing these improvements for common users</strong>, and in some cases it could be done pretty easily. Let&rsquo;s take OAuth2 authentication for instance: I think 99% of users don&rsquo;t use OAuth for anything other than authentication. It would make sense to have access to sensitive data (emails, drive and calendar) blocked by default in Gmail with an easy way to unlock it. Suddenly 99% of users become protected against OAuth phishing versus years of trainings to explain what is OAuth and how it can be abused (which is what we are doing right now).</p>
<p>Thanks to <a href="https://twitter.com/0xStarcat">Starcat</a> for their help :). You can contact me on <a href="https://twitter.com/tenacioustek">Twitter</a> if you have any comment or feedback on this article.</p>


              
          </article>
          

<ul class="tags__list">
    
    <li class="tag__item">
        <a class="tag__link" href="https://randhome.io/tags/security/">security</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://randhome.io/tags/google/">google</a>
    </li></ul>

 <div class="pagination">
  
    <a class="pagination__item" href="https://randhome.io/blog/2017/04/23/lets-talk-about-flexispy/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">Let&#39;s Talk About FlexiSpy</span>
    </a>
  

  
    <a class="pagination__item" href="https://randhome.io/blog/2018/02/04/another-pe-tool/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >Another PE tool</a>
    </a>
  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
    
    
      <a class="social-icons__icon" title="Twitter"
         style="background-image: url(/images/social/twitter.svg)"
         href="https://twitter.com/tenacioustek"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
      <a class="social-icons__icon" title="GitHub"
         style="background-image: url(/images/social/github.svg)"
         href="https://github.com/Te-k"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
      <a class="social-icons__icon" title="Email"
         style="background-image: url(/images/social/email.svg)"
         href="mailto:tek@randhome.io"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
</div>

            <p>© 2021</p>
          </footer>
          </div>
      </div>
      
    </div>


  </main>

   

  
  <script src="/js/index.min.575dda8d49ee02639942c63564273e6da972ab531dda26a08800bdcb477cbd7f.js" integrity="sha256-V13ajUnuAmOZQsY1ZCc&#43;balyq1Md2iagiAC9y0d8vX8=" crossorigin="anonymous"></script>
  
  


</body>

</html>
