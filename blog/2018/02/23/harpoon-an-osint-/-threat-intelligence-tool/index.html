<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Tek" />
    
    <link rel="shortcut icon" type="image/x-icon" href="https://www.randhome.io/img/favicon.ico">
    <title>Harpoon: an OSINT / Threat Intelligence tool</title>
    <meta name="generator" content="Hugo 0.68.2" />
    <link rel="stylesheet" type="text/css" href="https://www.randhome.io/css/bootstrap-3.3.7.min.css"/>
    <link rel="stylesheet" type="text/css" href="https://www.randhome.io/css/main.css" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,200bold,400old" />
    
    <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

    

    
    
    
    
    <link rel="canonical" href="https://www.randhome.io/blog/2018/02/23/harpoon-an-osint-/-threat-intelligence-tool/" />
  </head>

  <body>
    <div id="wrap">
      
      <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="https://www.randhome.io/"><i class="fa fa-home"></i></a>
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar">
            <ul class="nav navbar-nav navbar-right">
                
                    
                        <li><a href="/post/">BLOG</a></li>
                    
                        <li><a href="/resources/">RESOURCES</a></li>
                    
                
                <li class="lang-switcher dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" lang="en"><span class="lang"> <i class="fa fa-language"></i> EN </span></a>
                     <ul class="dropdown-menu">
                         
                            
                                
                            
                                
                                <li><a href="/fr" lang="fr" class="no-translation">FR</a></li>
                                
                            
                        
                     </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

      
      <div class="container">
        <div class="blog-post">
          <h2>
            <strong><a href="https://www.randhome.io/blog/2018/02/23/harpoon-an-osint-/-threat-intelligence-tool/">Harpoon: an OSINT / Threat Intelligence tool</a></strong>
          </h2>
        </div>
        <div class="blog-title">
          <h4>
              February 23, 2018  &middot; 12 minutes read 
            &nbsp;&nbsp;
            
            <span class="taglist">
                
                    <a class="label label-success" href="https://www.randhome.io/categories/osint">osint</a>
                
                    <a class="label label-success" href="https://www.randhome.io/categories/tools">tools</a>
                
            </span>
            
          </h4>
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="blogpost">
              <h2 id="tldr">TL;DR</h2>
<p><strong>Harpoon</strong> is a tool to automate threat intelligence and open source intelligence tasks. It is written in Python 3 and organised in plugins so the idea is to have one plugin per platform or task. The code is on <!-- raw HTML omitted -->Github<!-- raw HTML omitted -->, feel free to open <!-- raw HTML omitted -->issues<!-- raw HTML omitted --> and propose <!-- raw HTML omitted -->Pull Requests<!-- raw HTML omitted -->.</p>
<p>Install and config:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links
npm install -g phantomjs
harpoon config -u
harpoon config
</code></pre></div><p>Then check how to use every module with <code>harpoon help MODULE</code></p>
<h2 id="harpoon-">Harpoon ?</h2>
<p>For the past year and a half I have been pretty busy doing threat intelligence and open source intelligence on several malware operations. Threat Intelligence mainly relies on passive DNS/malware databases on one side, and databases on malicious activity on the other side. The objective is to map an attack&rsquo;s infrastructure and if possible link it with other malicious activities. Some threat intelligence platforms are accessible to everyone (like <!-- raw HTML omitted -->OTX<!-- raw HTML omitted --> or <!-- raw HTML omitted -->RobTex<!-- raw HTML omitted -->) while others are commercial with or without free access (like <!-- raw HTML omitted -->VirusTotal<!-- raw HTML omitted --> or <!-- raw HTML omitted -->PassiveTotal<!-- raw HTML omitted -->). In the end, a large part of this activity is about looking for information in different platforms. Many people have tried to create a platform centralizing information from other platforms, but we always end up having yet another platform to consider during the research.</p>
<figure class="center">
    <img src="/media/harpoon/xkcd927.png"
         alt="New standards problem totally applies to Threat Intelligence (xkcd 927)"/> <figcaption>
            <p>New standards problem totally applies to Threat Intelligence (<a href="https://xkcd.com/927/">xkcd 927</a>)</p>
        </figcaption>
</figure>

<p>Open Source Intelligence (aka OSINT) on the other side is way more diverse. The objective is to get as much information as possible on someone or a group of people using any data source openly accessible on Internet. Of course there are some interesting platforms (like <!-- raw HTML omitted -->SpyOnWeb<!-- raw HTML omitted -->) but you may also have to do research in social media, cache platforms and many other random tasks depending where your investigation leads you.</p>
<p>In all that, a large number of tasks are completely manual and it sucks.
At first, I tried to create <!-- raw HTML omitted -->random python scripts<!-- raw HTML omitted --> to automate some of these tasks but it became quickly a mess : too many scripts, some in python 2 some in python 3, some using config files and some getting API key in parameters&hellip; After a while, I started to organize these scripts as modules for a tool called <strong>Harpoon</strong> and after some months of using it, I think it is time to make it open source to see if it can help other people.</p>
<p>Some notes on the principles behind this tool :</p>
<ul>
<li>Python 3 only, python 2 is dead, I am not even trying to support it</li>
<li>Many OSINT tools try to gather as much information as possible from an indicator (domain or email) without really any interest on where it comes from. Harpoon does not follow this philosophy. It mostly allows you to realise a single task per command (with a couple of more general commmands using several tools). I think it is really important during an investigation to understand where an information comes from and how reliable it is.</li>
<li>In many cases, I also wanted to explore APIs to see what was possible with them, and I ended up rewriting some libraries (like <!-- raw HTML omitted -->SpyOnWeb<!-- raw HTML omitted -->) just because I wanted to understand exactly what it did and how. So I reinvented the wheel many times and I am totally fine with it.</li>
<li>Harpoon is organized into subcommands that are easy to implement, these commands rely on internal or external libraries. These commands also use a single configuration file that you need to complete manually when an API key is needed.</li>
<li>This tool is not perfect, it only does what I needed to automate, it is likely buggy and has a long list of <!-- raw HTML omitted -->things<!-- raw HTML omitted --> I would like to implement one day (but it may never happen). Feel free to open <!-- raw HTML omitted -->issues<!-- raw HTML omitted --> or propose <!-- raw HTML omitted -->Pull Requests<!-- raw HTML omitted -->.</li>
</ul>
<p>This post will be boring, mainly because I try to be as exhaustive as I can to complete the limited existing documentation about the tool. Feel free to jump to the sections you are interested to read</p>
<h2 id="install">Install</h2>
<p><strong>TL;DR:</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links
npm install -g phantomjs
harpoon config -u
harpoon config
</code></pre></div><p>Boring yet mandatory part: how to install Harpoon. I have tried to package it as much as possible through pip (with the great help of <!-- raw HTML omitted -->@cybersteez<!-- raw HTML omitted -->) so everything should be installable just with <code>pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links</code></p>
<p>The main challenge with the packaging is that many libraries I have written are hosted on github and not in Pypi (yet?), so the package should install them at the same time. Alternately, you can install everything from <code>requirements.txt</code> after you cloned the repository (<code>pip install -r requirements.txt</code>).</p>
<p>If you want to use the screenshot module (to take a screenshot of a website), you need to install it through npm : <code>npm install -g phantomjs</code></p>
<p>Now harpoon should be installed, you can check if it works with <code>harpoon help ip</code> for instance. Then you need to install files needed by Harpoon and configure it. To install files needed (for now, mainly the <a href="https://dev.maxmind.com/geoip/geoip2/geolite2/">MaxMind GeoIP</a> database), you just need to run <code>harpoon config -u</code> and wait. Finally, you need to configure the tool, mainly by providing the API keys of platforms you can/want to use. For this, just run <code>harpoon config</code>, it will copy the empty config file and open it with vim so that you can provide the given keys. If you don&rsquo;t have them, just leave the key empty and harpoon will avoid using the platform when possible. You can see the list of configured module with <code>harpoon config -c</code>. On my current system, it gives :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Configuration check:
-hibp            -&gt; OK
-twitter         -&gt; OK
-misp            -&gt; FAILED
-robtex          -&gt; OK
-totalhash       -&gt; OK
-pt              -&gt; OK
-asn             -&gt; OK
-otx             -&gt; OK
-bitly           -&gt; OK
-vt              -&gt; OK
-screenshot      -&gt; OK
-dns             -&gt; OK
-safebrowsing    -&gt; OK
-threatgrid      -&gt; OK
-help            -&gt; OK
-shodan          -&gt; OK
-greynoise       -&gt; OK
-crtsh           -&gt; OK
-domain          -&gt; OK
-pgp             -&gt; OK
-github          -&gt; OK
-malshare        -&gt; OK
-config          -&gt; OK
-hunter          -&gt; OK
-hybrid          -&gt; OK
-cache           -&gt; OK
-spyonweb        -&gt; OK
-telegram        -&gt; FAILED
-fullcontact     -&gt; OK
-ip              -&gt; OK
-censys          -&gt; OK
-googl           -&gt; OK
</code></pre></div><p>All the files needed by Harpoon (including config file) are installed in <code>~/.config/harpoon</code>.</p>
<h2 id="features">Features</h2>
<p>It is hard to describe the features without just listing the modules because I almost created a new command for every task I needed to automate. Let&rsquo;s try to organize in categories with examples :</p>
<ul>
<li><strong>Threat Intelligence platforms</strong> : <!-- raw HTML omitted -->Virus Total<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Passive Total<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Hybrid Analysis<!-- raw HTML omitted -->, <!-- raw HTML omitted -->AlienVault OTX<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Shodan<!-- raw HTML omitted -->, <!-- raw HTML omitted -->Censys<!-- raw HTML omitted -->, <!-- raw HTML omitted -->RobTex<!-- raw HTML omitted -->, <!-- raw HTML omitted -->ThreatGrid<!-- raw HTML omitted -->, <!-- raw HTML omitted -->GreyNoise<!-- raw HTML omitted -->, <!-- raw HTML omitted -->TotalHash<!-- raw HTML omitted -->, <!-- raw HTML omitted -->MISP<!-- raw HTML omitted -->, <!-- raw HTML omitted -->MalShare<!-- raw HTML omitted -->:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon otx <span style="color:#f92672">-</span>s cdnverify<span style="color:#f92672">.</span>net
No analysis on this file
Listed <span style="color:#f92672">in</span> <span style="color:#ae81ff">1</span> pulses
	<span style="color:#f92672">-</span>Sofacy targeting Romanian Embassy
		Sofacy targeting the embassy of Romania <span style="color:#f92672">in</span> Moscow <span style="color:#f92672">-</span>  Email Subject: Upcoming Defense events February <span style="color:#ae81ff">2018</span>
		Created: <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span>T11:<span style="color:#ae81ff">50</span>:<span style="color:#ae81ff">07.652000</span>
		References: https:<span style="color:#f92672">//</span>twitter<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>ClearskySec<span style="color:#f92672">/</span>status<span style="color:#f92672">/</span><span style="color:#ae81ff">960924755355369472</span>
		id: <span style="color:#ae81ff">5</span>a7c396f6db26d7636273c44
URL list:
	[<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T19:<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">50</span>] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> on IP <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
	[<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>T18:<span style="color:#ae81ff">44</span>:<span style="color:#ae81ff">09</span>] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> on IP <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
</code></pre></div><ul>
<li>On top of that, I have implemented some higher level commands to gather information from all these platforms with <strong>ip</strong> and <strong>domain</strong>. These commands search for interesting information from almost all the configured plugins:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon domain intel cdnverify<span style="color:#f92672">.</span>net
<span style="color:#75715e">###################### cdnverify.net ###################</span>
[<span style="color:#f92672">+</span>] Downloading OTX information<span style="color:#f92672">....</span>
[<span style="color:#f92672">+</span>] Downloading Robtex information<span style="color:#f92672">....</span>
[<span style="color:#f92672">+</span>] Downloading Passive Total information<span style="color:#f92672">....</span>
[<span style="color:#f92672">+</span>] Downloading VT information<span style="color:#f92672">....</span>
<span style="color:#f92672">-----------------</span> Intelligence Report
OTX:
 <span style="color:#f92672">-</span>Sofacy targeting Romanian Embassy (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>otx<span style="color:#f92672">.</span>alienvault<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>pulse<span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>a7c396f6db26d7636273c44)
PT: Nothing found<span style="color:#960050;background-color:#1e0010">!</span>
<span style="color:#f92672">-----------------</span> Malware
[PT (Emerging Threats (Proofpoint))] <span style="color:#ae81ff">36524</span>c90ca1fac2102e7653dfadb31b2 <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>
<span style="color:#f92672">-----------------</span> Urls
[VT] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>  <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">15</span>
[VT] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>  <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>
[OTX] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>
[OTX] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>
<span style="color:#f92672">-----------------</span> Passive DNS
[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span>)(PT)
[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>)(VT)
[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>)(Robtex)
[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">208.91</span><span style="color:#f92672">.</span><span style="color:#ae81ff">197.91</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span>)(PT)
</code></pre></div><ul>
<li><strong>Network information</strong> : the commands <strong>ip</strong>, <strong>dns</strong> and <strong>asn</strong> provide basic information about an IP, domain or ASN number (location, dns resolutions or information on the ASN). Nothing fancy but it helps all the time:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon ip info <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
MaxMind: Located <span style="color:#f92672">in</span> Roubaix, France
MaxMind: ASN16276, OVH SAS
ASN <span style="color:#ae81ff">16276</span> <span style="color:#f92672">-</span> OVH, FR (range <span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">16</span>)

Censys:		https:<span style="color:#f92672">//</span>censys<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>ipv4<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
Shodan:		https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>shodan<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>host<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
IP Info:	http:<span style="color:#f92672">//</span>ipinfo<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
BGP HE:		https:<span style="color:#f92672">//</span>bgp<span style="color:#f92672">.</span>he<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>ip<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
IP Location:	https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>query<span style="color:#f92672">=</span><span style="color:#ae81ff">151.80</span><span style="color:#f92672">.</span><span style="color:#ae81ff">74.167</span>
</code></pre></div><ul>
<li><strong>Social media</strong> : when researching in social media platforms (not sure the API is the best way to do that), I find that saving everything from a social media account quickly is really helpful during an investigation (i.e. before Twitter deletes Russian trolls). Same idea with the <strong>screenshot</strong> command which take a screenshot of a website. For now, only Twitter and Telegram exists:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon twitter <span style="color:#f92672">-</span>s realDonaldTrump <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">@realDonaldTrump</span>
</code></pre></div><ul>
<li><strong>URL shorteners</strong> : I have also implemented commands for bit.ly and goo.gl url shorteners, the idea is to be able to get as much data as possible from the API:</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Ruby" data-lang="Ruby"><span style="color:#960050;background-color:#1e0010">$</span> harpoon bitly <span style="color:#f92672">-</span>H <span style="color:#ae81ff">2</span>oh6Nrj
<span style="color:#f92672">--------------------</span> <span style="color:#66d9ef">Bit</span><span style="color:#f92672">.</span>ly <span style="color:#66d9ef">Link</span> infos <span style="color:#f92672">-------------------</span>
<span style="color:#75715e"># INFO</span>
<span style="color:#e6db74">Link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>oh6Nrj		<span style="color:#e6db74">Metrics</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>oh6Nrj<span style="color:#f92672">+</span>
<span style="color:#66d9ef">Expanded</span> <span style="color:#e6db74">url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
<span style="color:#66d9ef">Creation</span> <span style="color:#e6db74">Date</span>: <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">03</span>
<span style="color:#66d9ef">Aggregate</span> <span style="color:#e6db74">link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">E6V2dF</span>
<span style="color:#ae81ff">2</span> bitly redirect to this url

<span style="color:#75715e"># LINK  INFO</span>
<span style="color:#e6db74">original_url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
<span style="color:#e6db74">canonical_url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
<span style="color:#e6db74">html_title</span>: <span style="color:#66d9ef">OONI</span> <span style="color:#f92672">-</span> I have hands, how can I mine <span style="color:#66d9ef">OONI</span> data?
<span style="color:#e6db74">aggregate_link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">E6V2dF</span>
<span style="color:#e6db74">indexed</span>: <span style="color:#ae81ff">1519017306</span>

<span style="color:#75715e"># USERS</span>
<span style="color:#e6db74">User</span>: <span style="color:#ae81ff">2</span>oh6Nrj
<span style="color:#66d9ef">Invalid</span> user!

<span style="color:#75715e"># CLICKS</span>
<span style="color:#ae81ff">0</span> clicks on this link

<span style="color:#75715e"># COUNTRIES</span>

<span style="color:#75715e"># REFERRERS</span>
</code></pre></div><ul>
<li>And then, there are other commands I implemented because I wanted to see what I could get with some APIs. For instance, there is a command for <strong>github</strong> to search in github repos, or <strong>pgp</strong> to search for keys. One command I like particularly is the <strong>cache</strong> command which check for the existence of a web page in different cache platforms.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#960050;background-color:#1e0010">$</span> harpoon cache <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>citizenlab<span style="color:#f92672">.</span>ca<span style="color:#f92672">/</span><span style="color:#ae81ff">2016</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>parliament<span style="color:#f92672">-</span>keyboy<span style="color:#f92672">/</span>
<span style="color:#e6db74">Google</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>webcache<span style="color:#f92672">.</span>googleusercontent<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>search?q<span style="color:#f92672">=</span>cache<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#66d9ef">Ahttps</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>strip<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&amp;</span>num<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&amp;</span>vwsrc<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>)
<span style="color:#e6db74">Yandex</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>hghltd<span style="color:#f92672">.</span>yandex<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>yandbtm?fmode<span style="color:#f92672">=</span>inject<span style="color:#f92672">&amp;</span>url<span style="color:#f92672">=</span>https<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>tld<span style="color:#f92672">=</span>ru<span style="color:#f92672">&amp;</span>lang<span style="color:#f92672">=</span>en<span style="color:#f92672">&amp;</span>la<span style="color:#f92672">=</span><span style="color:#ae81ff">1518660992</span><span style="color:#f92672">&amp;</span>tm<span style="color:#f92672">=</span><span style="color:#ae81ff">1519019381</span><span style="color:#f92672">&amp;</span>text<span style="color:#f92672">=</span>https<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>l10n<span style="color:#f92672">=</span>ru<span style="color:#f92672">&amp;</span>mime<span style="color:#f92672">=</span>html<span style="color:#f92672">&amp;</span>sign<span style="color:#f92672">=</span>ef543d285bc848b89e51b5a654f7f6aa<span style="color:#f92672">&amp;</span>keyno<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">Archive</span><span style="color:#f92672">.</span>is: <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">FOUND</span>
<span style="color:#66d9ef">Archive</span><span style="color:#f92672">.</span>org: <span style="color:#66d9ef">FOUND</span>
<span style="color:#f92672">-</span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">03</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>web<span style="color:#f92672">.</span>archive<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>web<span style="color:#f92672">/</span><span style="color:#ae81ff">20180203100503</span><span style="color:#f92672">/</span><span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>citizenlab<span style="color:#f92672">.</span>ca<span style="color:#f92672">/</span><span style="color:#ae81ff">2016</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>parliament<span style="color:#f92672">-</span>keyboy<span style="color:#f92672">/</span>
<span style="color:#e6db74">Bing</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>cc<span style="color:#f92672">.</span>bingj<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>cache<span style="color:#f92672">.</span>aspx?d<span style="color:#f92672">=</span><span style="color:#ae81ff">5023416941477933</span><span style="color:#f92672">&amp;</span>w<span style="color:#f92672">=</span>p_fS69zzGSfsYoCCryqQAHXJ09tpPdBB (<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>)
</code></pre></div><ul>
<li>Last but not least, the <strong>help</strong> commands gives (hopefully) detailed information on any command :</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon help ip
<span style="color:#75715e"># IP</span>

Gathers information on an IP address

Get information on an IP:

harpoon ip info <span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>
MaxMind: Located <span style="color:#f92672">in</span> None, United States
MaxMind: ASN21928, T<span style="color:#f92672">-</span>Mobile USA, Inc<span style="color:#f92672">.</span>
ASN <span style="color:#ae81ff">21928</span> <span style="color:#f92672">-</span> T<span style="color:#f92672">-</span>MOBILE<span style="color:#f92672">-</span>AS21928 <span style="color:#f92672">-</span> T<span style="color:#f92672">-</span>Mobile USA, Inc<span style="color:#f92672">.</span>, US (range <span style="color:#ae81ff">172.32</span><span style="color:#f92672">.</span><span style="color:#ae81ff">0.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span>)

Censys:     https:<span style="color:#f92672">//</span>censys<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>ipv4<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>
Shodan:     https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>shodan<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>host<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>
IP Info:    http:<span style="color:#f92672">//</span>ipinfo<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>
BGP HE:     https:<span style="color:#f92672">//</span>bgp<span style="color:#f92672">.</span>he<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>ip<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>
IP Location:    https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>query<span style="color:#f92672">=</span><span style="color:#ae81ff">172.34</span><span style="color:#f92672">.</span><span style="color:#ae81ff">127.2</span>

<span style="color:#f92672">*</span> Get intelligence information on an IP: harpoon ip intel IP
</code></pre></div><h2 id="harpoontools">harpoontools</h2>
<p>At some point, I got sick of using <code>harpoon XXX</code> for some commands I was using all the time. So I created a repository <!-- raw HTML omitted -->harpoontools<!-- raw HTML omitted --> that installs commands using Harpoon features. You can install it through <code>pip install git+ssh://git@github.com/Te-k/harpoontools</code></p>
<p>For now I have only implemented <strong>ipinfo</strong>, <strong>asninfo</strong> and <strong>dns</strong> :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> cat ips <span style="color:#f92672">|</span> ipinfo
<span style="color:#ae81ff">66.249</span><span style="color:#f92672">.</span><span style="color:#ae81ff">66.6</span> ; ASN15169 ; Google LLC ; Mountain View ; United States
<span style="color:#ae81ff">184.105</span><span style="color:#f92672">.</span><span style="color:#ae81ff">139.116</span> ; ASN6939 ; Hurricane Electric, Inc<span style="color:#f92672">.</span> ; Fremont ; United States
<span style="color:#ae81ff">184.105</span><span style="color:#f92672">.</span><span style="color:#ae81ff">247.206</span> ; ASN6939 ; Hurricane Electric, Inc<span style="color:#f92672">.</span> ; Salt Lake City ; United States
</code></pre></div><h2 id="example">Example</h2>
<p>It is hard to give a real-life example of Harpoon as it is helpful for different types of investigations, but let&rsquo;s try with the recent Palo Alto report about <!-- raw HTML omitted -->Quasar RAT<!-- raw HTML omitted --> and focus on the domain <code>akamaicdn[.]ru</code>.</p>
<p>First let&rsquo;s check what is the actual DNS resolution :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon  dns akamaicdn[<span style="color:#f92672">.</span>]ru
<span style="color:#75715e"># A</span>
No A entry

<span style="color:#75715e"># AAAA</span>
No AAAA entry configured

<span style="color:#75715e"># NS</span>
ns2<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">176.99</span><span style="color:#f92672">.</span><span style="color:#ae81ff">13.12</span> <span style="color:#f92672">-</span> ASN197695 Domain names registrar REG<span style="color:#f92672">.</span>RU, Ltd <span style="color:#f92672">-</span> None Russia
ns1<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">176.99</span><span style="color:#f92672">.</span><span style="color:#ae81ff">13.15</span> <span style="color:#f92672">-</span> ASN197695 Domain names registrar REG<span style="color:#f92672">.</span>RU, Ltd <span style="color:#f92672">-</span> None Russia

<span style="color:#75715e"># MX:</span>
No MX entry configured

<span style="color:#75715e"># SOA</span>
NS: ns1<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span>
Owner: hostmaster<span style="color:#f92672">.</span>ns1<span style="color:#a6e22e">@reg.ru</span>

<span style="color:#75715e"># TXT:</span>
No TXT entry configured
</code></pre></div><p>No A entry, I guess the operation stopped. Let&rsquo;s see if we can get any older IP with robtex:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon robtex domain akamaicdn<span style="color:#f92672">.</span>ru
Passive DNS info:
[<span style="color:#f92672">+</span>] A	<span style="color:#ae81ff">194.85</span><span style="color:#f92672">.</span><span style="color:#ae81ff">61.76</span>	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
[<span style="color:#f92672">+</span>] NS	ns1<span style="color:#f92672">.</span>expired<span style="color:#f92672">.</span>r01<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
[<span style="color:#f92672">+</span>] A	<span style="color:#ae81ff">109.70</span><span style="color:#f92672">.</span><span style="color:#ae81ff">26.37</span>	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
[<span style="color:#f92672">+</span>] NS	ns2<span style="color:#f92672">.</span>expired<span style="color:#f92672">.</span>r01<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
[<span style="color:#f92672">+</span>] MX	nomail<span style="color:#f92672">.</span>nic<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</code></pre></div><p>Let&rsquo;s check where these IPs are:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> ipinfo <span style="color:#ae81ff">194.85</span><span style="color:#f92672">.</span><span style="color:#ae81ff">61.76</span> <span style="color:#ae81ff">109.70</span><span style="color:#f92672">.</span><span style="color:#ae81ff">26.37</span>
<span style="color:#ae81ff">194.85</span><span style="color:#f92672">.</span><span style="color:#ae81ff">61.76</span> ; ASN48287 ; Jsc ru<span style="color:#f92672">-</span>center ; Moscow ; Russia
<span style="color:#ae81ff">109.70</span><span style="color:#f92672">.</span><span style="color:#ae81ff">26.37</span> ; ASN48287 ; Jsc ru<span style="color:#f92672">-</span>center ; None ; Russia
</code></pre></div><p>We can check if certificates were created for this domain with crt.sh :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon crtsh <span style="color:#f92672">-</span>d akamaicdn<span style="color:#f92672">.</span>ru
Certificates
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	B05CB0F1425FBFA7E9407C777C6B4DC0E3F7F1B6
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">7</span>B9F1F8A2F7211C332C60EBFDB6CF739DF7D2A3A
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">22</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	D372B140802DA627BD0745B447A9E3A48B2FBD15
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">3868</span>C466BC8D131B2EB6B65CD7B20E7FFB255C51
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	BBEBA7914A4287C8BDDCD81510A327D33E6476F5
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	F0F0A0D02A8E16B3A261382D75B8C96393A16264
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">27</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	E285191C82EA0F5FD23EF4688A62E5772F4584D4
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">7</span>F40B0D369700BFC27C2AD2EB858D8DF4955624D
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	EDE5454F23BBC7BFBA17F2E293D7FBDD1266B260
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">68</span>D504FAEB6AF1DDA50062B16CBFB46AAD490171
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2</span>F2231766F8432343B579DB21ECF829CB171E481
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	B11FCBEAD0A2D174C661D8095A0693955FC62A99
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">62578</span>BABE0AFFE15ABE3FBD68A6EE8EF76AB556A
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">5630</span>B82083D14B0D5202FEAC7566971ECA41BBDC
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	D5A7B4CC6DF2340E8F547E3CC0A17163A81FD51A
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">500</span>DA087F038AEB5A37D9F60638332DBA8368BA2
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	C54AEC0DA67F1B12A134C6B997EE93DFA0EEE4F2
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	E746CD3581198237D3D26F8A80FF71BAD88D1544
sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">451608653</span>F741F079CC52569F7FAFB8C5B1F8855
</code></pre></div><p>So apparently they used Cloudfare to host this domain. We likely have a partial view of passive DNS information due to Robtex limitations, but let&rsquo;s check if OTX knows anything about the IP address <code>194.85.61.76</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> harpoon otx <span style="color:#f92672">-</span>s <span style="color:#ae81ff">194.85</span><span style="color:#f92672">.</span><span style="color:#ae81ff">61.76</span>
No analysis on this file
Listed <span style="color:#f92672">in</span> <span style="color:#ae81ff">5</span> pulses
	<span style="color:#f92672">-</span>BadRabbit<span style="color:#f92672">-</span>Ransomware <span style="color:#f92672">-</span> A Modified Version of NotPetya

		Created: <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T17:<span style="color:#ae81ff">58</span>:<span style="color:#ae81ff">14.502000</span>
		References:
		id: <span style="color:#ae81ff">59</span>fcae36f0c4a216de3560ea
	<span style="color:#f92672">-</span>Blueliv Chasing cybercrime: Vawtrak v2 IOCs
		Vawtrak <span style="color:#f92672">is</span> a serious threat <span style="color:#66d9ef">for</span> the finance sector <span style="color:#f92672">and</span> <span style="color:#f92672">is</span> predicted to be the next major banking Trojan<span style="color:#f92672">.</span> Blueliv<span style="color:#f92672">&amp;</span><span style="color:#75715e">#39;s investigation into Vawtrak v2 has revealed new information to piece together a more complete view of the Vawtrak banking Trojan and the cybercriminal groups behind it than we&amp;#39;ve seen before. The report also provides real infection data and Indicators of Compromise (IoCs) that readers can input into their existing security solutions to enhance their protection. Here is the full list of Vawtrak and Moskalvzapoe IOCs discovered as part of the Blueliv analysis.</span>
		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>T17:<span style="color:#ae81ff">36</span>:<span style="color:#ae81ff">18.734000</span>
		References: https:<span style="color:#f92672">//</span>community<span style="color:#f92672">.</span>blueliv<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#75715e">#/s/57d6d33d82df41127d7a6ca4, https://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-vawtrak-v2-sahin-wyke.pdf?la=en</span>
		id: <span style="color:#ae81ff">57</span>d6e794aa954c115b68a85f
	<span style="color:#f92672">-</span>Ursnif CnC

		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>T00:<span style="color:#ae81ff">35</span>:<span style="color:#ae81ff">04.809000</span>
		References:
		id: <span style="color:#ae81ff">56</span>c3c03867db8c12501745c6
	<span style="color:#f92672">-</span>Angler EK Network IOC
		Angler EK Network IOC observed <span style="color:#f92672">in</span> the past year<span style="color:#f92672">.</span>
		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>T15:<span style="color:#ae81ff">25</span>:<span style="color:#ae81ff">35.814000</span>
		References:
		id: <span style="color:#ae81ff">56</span>c490f067db8c1250175b9d
	<span style="color:#f92672">-</span>Chinese Government Website Compromised, Leads to Angler
		Despite a recent takedown targeting the Angler Exploit Kit (EK), it<span style="color:#e6db74">&#39;s back to business as usual for kit operators. On 30-October-2015, ThreatLabZ noticed a compromised Chinese government website that led to the Angler Exploit Kit with an end payload of Cryptowall 3.0. This compromise does not appear targeted and the compromised site was cleaned up within 24 hours. We have noticed some recent changes to Angler, as well as the inclusion of newer Flash exploits. A set of indicators for this compromise is at the end of this post.</span>
		Created: <span style="color:#ae81ff">2015</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T19:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">57.947000</span>
		References: http:<span style="color:#f92672">//</span>research<span style="color:#f92672">.</span>zscaler<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#ae81ff">2015</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>chinese<span style="color:#f92672">-</span>government<span style="color:#f92672">-</span>website<span style="color:#f92672">-</span>compromised<span style="color:#f92672">.</span>html
		id: <span style="color:#ae81ff">563909554637</span>f2388aaf2311
Passive DNS:
[SNIP]
</code></pre></div><h2 id="create-a-new-command">Create a new command</h2>
<p>Harpoon is a plugin-based tool, so it is pretty easy to add new features just by creating new plugins. To do so, you need to create a new file in harpoon/commands and implement a class inheriting the Command class. Let&rsquo;s say we would like to implement a ping command (which would not be really helpful), we could create the following <code>ping.py</code> file :</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> os
<span style="color:#f92672">from</span> harpoon.commands.base <span style="color:#f92672">import</span> Command


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CommandPing</span>(Command):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">    # Ping
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    Here put the help in markdown format
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ping&#34;</span>
    decription <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Ping command&#34;</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_arguments</span>(self, parser):
        <span style="color:#75715e"># Here add arguments to the parser (which is an argparse parser)</span>
        parser<span style="color:#f92672">.</span>add_arguments(<span style="color:#e6db74">&#39;IP&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;IP to ping&#39;</span>)
        <span style="color:#75715e"># It is nice to save the parser to call help later if needed</span>
        self<span style="color:#f92672">.</span>parser <span style="color:#f92672">=</span> parser

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self, conf, args, plugins):
        <span style="color:#75715e"># here, implements the actual task</span>
        <span style="color:#75715e"># args contains the arguments received from the parser</span>
        os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;ping -c 1 &#34;</span> <span style="color:#f92672">+</span> args<span style="color:#f92672">.</span>IP)
</code></pre></div><p>That&rsquo;s all folks, feel free to play with it and open <!-- raw HTML omitted -->issues<!-- raw HTML omitted --> and submit <!-- raw HTML omitted -->pull requests<!-- raw HTML omitted -->. You can also ping me on <!-- raw HTML omitted -->Twitter<!-- raw HTML omitted -->.</p>
<p>Thanks to <!-- raw HTML omitted -->Starcat<!-- raw HTML omitted --> for the feedback on the blog post! Most of this text was written while listening to Amanda Palmer singing <!-- raw HTML omitted -->No Surprises<!-- raw HTML omitted -->.</p>

              
            </div>
          </div>
          <hr>
        

        </div>
      </div>
      
    </div>

    
    <footer>
  <div id="footer">
    <div class="container">
        
            <p class="text-muted">
                
                    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a>
                
                Powered by <a href="https://gohugo.io/">Hugo</a> and <a href="http://www.github.com/nurlansu/hugo-sustain/">sustain</a>
                
                    
                    
                    
                
            </p>
        
    </div>
  </div>
</footer>
<div class="footer"></div>


<script src="https://www.randhome.io/js/jquery-1.11.3.min.js"></script>

<script src="https://www.randhome.io/js/bootstrap-3.3.7.min.js"></script>
<script src="https://www.randhome.io/js/docs.min.js"></script>
<script src="https://www.randhome.io/js/main.js"></script>

<script src="https://www.randhome.io/js/ie10-viewport-bug-workaround.js"></script>



  </body>
</html>
