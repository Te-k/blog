<!DOCTYPE html>
<html lang="en">

<head>
  <title>Harpoon: an OSINT / Threat Intelligence tool | </title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />

  
  
    
 
  
  

  

  
    
    <link rel="stylesheet" href="/css/post.min.b55e48a57c205580facfa82070761940c943e10b594ebdb023151ba0ff1d16cc.css" integrity="sha256-tV5IpXwgVYD6z6ggcHYZQMlD4QtZTr2wIxUboP8dFsw="/>
  
    
    <link rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa&#43;/TImW&#43;5JCeuQeRkm5NMpJWZG3hSuFU="/>
  

  
   
    

<script type="application/ld+json">
  
    { 
      "@context": "http://schema.org", 
      "@type": "WebSite", 
      "url": "https:\/\/maynier.eu\/blog\/2018\/02\/23\/harpoon-an-osint-\/-threat-intelligence-tool\/",
      "name": "Harpoon: an OSINT \/ Threat Intelligence tool",
      "author": {
        "@type": "Person",
        "name": ""
      },
      "description": ""
    }
  
  </script>


</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>


  <nav class="nav" role="navigation">
  <ul class="nav__list">
    
    
      <li>
          
          
          
        <a  class="active" href="/">home</a>
      </li>
    
      <li>
          
          
          
        <a  class="active" href="/post/">blog</a>
      </li>
    
      <li>
          
          
          
        <a  href="/projects/">projects</a>
      </li>
    
      <li>
          
          
          
        <a  href="/resources/">resources</a>
      </li>
    
      <li>
          
          
          
        <a  href="/about/">about</a>
      </li>
    
      <li>
          
          
          
        <a  href="/contact/">contact</a>
      </li>
    
    <li></li>
    <li>
        
        EN
        
        
        
            <a href="/fr" lang="fr" class="no-translation">FR</a>
        
        
    </li>
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">Harpoon: an OSINT / Threat Intelligence tool</h1>
            <time datetime="2018-02-23 00:00:00 -0500 -0500" class="post__date">23 Feb 2018   &middot; 12 minutes read </time>
          </header>
          <article class="post__content">
              
<h2 id="tldr">TL;DR<a class="anchor" href="#tldr">#</a></h2>
<p><strong>Harpoon</strong> is a tool to automate threat intelligence and open source intelligence tasks. It is written in Python 3 and organised in plugins so the idea is to have one plugin per platform or task. The code is on <a href="https://github.com/Te-k/harpoon" target="_blank">Github</a>, feel free to open <a href="https://github.com/Te-k/harpoon/issues" target="_blank">issues</a> and propose <a href="https://github.com/Te-k/harpoon/pulls" target="_blank">Pull Requests</a>.</p>
<p>Install and config:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links
</span></span><span style="display:flex;"><span>npm install -g phantomjs
</span></span><span style="display:flex;"><span>harpoon config -u
</span></span><span style="display:flex;"><span>harpoon config
</span></span></code></pre></div><p>Then check how to use every module with <code>harpoon help MODULE</code></p>
<h2 id="harpoon-">Harpoon ?<a class="anchor" href="#harpoon-">#</a></h2>
<p>For the past year and a half I have been pretty busy doing threat intelligence and open source intelligence on several malware operations. Threat Intelligence mainly relies on passive DNS/malware databases on one side, and databases on malicious activity on the other side. The objective is to map an attack&rsquo;s infrastructure and if possible link it with other malicious activities. Some threat intelligence platforms are accessible to everyone (like <a href="https://otx.alienvault.com/" target="_blank">OTX</a> or <a href="https://www.robtex.com/" target="_blank">RobTex</a>) while others are commercial with or without free access (like <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a> or <a href="https://community.riskiq.com/" target="_blank">PassiveTotal</a>). In the end, a large part of this activity is about looking for information in different platforms. Many people have tried to create a platform centralizing information from other platforms, but we always end up having yet another platform to consider during the research.</p>
<figure class="center"><img src="/media/harpoon/xkcd927.png"
    alt="New standards problem totally applies to Threat Intelligence (xkcd 927)"><figcaption>
      <p>New standards problem totally applies to Threat Intelligence (<a href="https://xkcd.com/927/">xkcd 927</a>)</p>
    </figcaption>
</figure>

<p>Open Source Intelligence (aka OSINT) on the other side is way more diverse. The objective is to get as much information as possible on someone or a group of people using any data source openly accessible on Internet. Of course there are some interesting platforms (like <a href="http://spyonweb.com/" target="_blank">SpyOnWeb</a>) but you may also have to do research in social media, cache platforms and many other random tasks depending where your investigation leads you.</p>
<p>In all that, a large number of tasks are completely manual and it sucks.
At first, I tried to create <a href="https://github.com/Te-k/analyst-scripts" target="_blank">random python scripts</a> to automate some of these tasks but it became quickly a mess : too many scripts, some in python 2 some in python 3, some using config files and some getting API key in parameters&hellip; After a while, I started to organize these scripts as modules for a tool called <strong>Harpoon</strong> and after some months of using it, I think it is time to make it open source to see if it can help other people.</p>
<p>Some notes on the principles behind this tool :</p>
<ul>
<li>Python 3 only, python 2 is dead, I am not even trying to support it</li>
<li>Many OSINT tools try to gather as much information as possible from an indicator (domain or email) without really any interest on where it comes from. Harpoon does not follow this philosophy. It mostly allows you to realise a single task per command (with a couple of more general commmands using several tools). I think it is really important during an investigation to understand where an information comes from and how reliable it is.</li>
<li>In many cases, I also wanted to explore APIs to see what was possible with them, and I ended up rewriting some libraries (like <a href="https://github.com/Te-k/spyonweb" target="_blank">SpyOnWeb</a>) just because I wanted to understand exactly what it did and how. So I reinvented the wheel many times and I am totally fine with it.</li>
<li>Harpoon is organized into subcommands that are easy to implement, these commands rely on internal or external libraries. These commands also use a single configuration file that you need to complete manually when an API key is needed.</li>
<li>This tool is not perfect, it only does what I needed to automate, it is likely buggy and has a long list of <a href="https://github.com/Te-k/harpoon/issues" target="_blank">things</a> I would like to implement one day (but it may never happen). Feel free to open <a href="https://github.com/Te-k/harpoon/issues" target="_blank">issues</a> or propose <a href="https://github.com/Te-k/harpoon/pulls" target="_blank">Pull Requests</a>.</li>
</ul>
<p>This post will be boring, mainly because I try to be as exhaustive as I can to complete the limited existing documentation about the tool. Feel free to jump to the sections you are interested to read</p>
<h2 id="install">Install<a class="anchor" href="#install">#</a></h2>
<p><strong>TL;DR:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links
</span></span><span style="display:flex;"><span>npm install -g phantomjs
</span></span><span style="display:flex;"><span>harpoon config -u
</span></span><span style="display:flex;"><span>harpoon config
</span></span></code></pre></div><p>Boring yet mandatory part: how to install Harpoon. I have tried to package it as much as possible through pip (with the great help of <a href="https://twitter.com/cybersteez" target="_blank">@cybersteez</a>) so everything should be installable just with <code>pip install git+ssh://git@github.com/Te-k/harpoon  --process-dependency-links</code></p>
<p>The main challenge with the packaging is that many libraries I have written are hosted on github and not in Pypi (yet?), so the package should install them at the same time. Alternately, you can install everything from <code>requirements.txt</code> after you cloned the repository (<code>pip install -r requirements.txt</code>).</p>
<p>If you want to use the screenshot module (to take a screenshot of a website), you need to install it through npm : <code>npm install -g phantomjs</code></p>
<p>Now harpoon should be installed, you can check if it works with <code>harpoon help ip</code> for instance. Then you need to install files needed by Harpoon and configure it. To install files needed (for now, mainly the <a href="https://dev.maxmind.com/geoip/geoip2/geolite2/">MaxMind GeoIP</a> database), you just need to run <code>harpoon config -u</code> and wait. Finally, you need to configure the tool, mainly by providing the API keys of platforms you can/want to use. For this, just run <code>harpoon config</code>, it will copy the empty config file and open it with vim so that you can provide the given keys. If you don&rsquo;t have them, just leave the key empty and harpoon will avoid using the platform when possible. You can see the list of configured module with <code>harpoon config -c</code>. On my current system, it gives :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Configuration check:
</span></span><span style="display:flex;"><span>-hibp            -&gt; OK
</span></span><span style="display:flex;"><span>-twitter         -&gt; OK
</span></span><span style="display:flex;"><span>-misp            -&gt; FAILED
</span></span><span style="display:flex;"><span>-robtex          -&gt; OK
</span></span><span style="display:flex;"><span>-totalhash       -&gt; OK
</span></span><span style="display:flex;"><span>-pt              -&gt; OK
</span></span><span style="display:flex;"><span>-asn             -&gt; OK
</span></span><span style="display:flex;"><span>-otx             -&gt; OK
</span></span><span style="display:flex;"><span>-bitly           -&gt; OK
</span></span><span style="display:flex;"><span>-vt              -&gt; OK
</span></span><span style="display:flex;"><span>-screenshot      -&gt; OK
</span></span><span style="display:flex;"><span>-dns             -&gt; OK
</span></span><span style="display:flex;"><span>-safebrowsing    -&gt; OK
</span></span><span style="display:flex;"><span>-threatgrid      -&gt; OK
</span></span><span style="display:flex;"><span>-help            -&gt; OK
</span></span><span style="display:flex;"><span>-shodan          -&gt; OK
</span></span><span style="display:flex;"><span>-greynoise       -&gt; OK
</span></span><span style="display:flex;"><span>-crtsh           -&gt; OK
</span></span><span style="display:flex;"><span>-domain          -&gt; OK
</span></span><span style="display:flex;"><span>-pgp             -&gt; OK
</span></span><span style="display:flex;"><span>-github          -&gt; OK
</span></span><span style="display:flex;"><span>-malshare        -&gt; OK
</span></span><span style="display:flex;"><span>-config          -&gt; OK
</span></span><span style="display:flex;"><span>-hunter          -&gt; OK
</span></span><span style="display:flex;"><span>-hybrid          -&gt; OK
</span></span><span style="display:flex;"><span>-cache           -&gt; OK
</span></span><span style="display:flex;"><span>-spyonweb        -&gt; OK
</span></span><span style="display:flex;"><span>-telegram        -&gt; FAILED
</span></span><span style="display:flex;"><span>-fullcontact     -&gt; OK
</span></span><span style="display:flex;"><span>-ip              -&gt; OK
</span></span><span style="display:flex;"><span>-censys          -&gt; OK
</span></span><span style="display:flex;"><span>-googl           -&gt; OK
</span></span></code></pre></div><p>All the files needed by Harpoon (including config file) are installed in <code>~/.config/harpoon</code>.</p>
<h2 id="features">Features<a class="anchor" href="#features">#</a></h2>
<p>It is hard to describe the features without just listing the modules because I almost created a new command for every task I needed to automate. Let&rsquo;s try to organize in categories with examples :</p>
<ul>
<li><strong>Threat Intelligence platforms</strong> : <a href="https://virustotal.com/" target="_blank">Virus Total</a>, <a href="https://community.riskiq.com/" target="_blank">Passive Total</a>, <a href="https://www.hybrid-analysis.com/" target="_blank">Hybrid Analysis</a>, <a href="https://otx.alienvault.com/" target="_blank">AlienVault OTX</a>, <a href="https://www.shodan.io/" target="_blank">Shodan</a>, <a href="https://censys.io/" target="_blank">Censys</a>, <a href="https://www.robtex.com/" target="_blank">RobTex</a>, <a href="https://www.cisco.com/c/en/us/products/security/threat-grid/index.html" target="_blank">ThreatGrid</a>, <a href="https://greynoise.io/" target="_blank">GreyNoise</a>, <a href="https://totalhash.cymru.com/" target="_blank">TotalHash</a>, <a href="http://www.misp-project.org/" target="_blank">MISP</a>, <a href="http://malshare.com/" target="_blank">MalShare</a>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon otx <span style="color:#f92672">-</span>s cdnverify<span style="color:#f92672">.</span>net
</span></span><span style="display:flex;"><span>No analysis on this file
</span></span><span style="display:flex;"><span>Listed <span style="color:#f92672">in</span> <span style="color:#ae81ff">1</span> pulses
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>Sofacy targeting Romanian Embassy
</span></span><span style="display:flex;"><span>		Sofacy targeting the embassy of Romania <span style="color:#f92672">in</span> Moscow <span style="color:#f92672">-</span>  Email Subject: Upcoming Defense events February <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span>T11:<span style="color:#ae81ff">50</span>:<span style="color:#ae81ff">07.652000</span>
</span></span><span style="display:flex;"><span>		References: https:<span style="color:#f92672">//</span>twitter<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>ClearskySec<span style="color:#f92672">/</span>status<span style="color:#f92672">/</span><span style="color:#ae81ff">960924755355369472</span>
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">5</span>a7c396f6db26d7636273c44
</span></span><span style="display:flex;"><span>URL list:
</span></span><span style="display:flex;"><span>	[<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T19:<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">50</span>] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> on IP <span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>	[<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>T18:<span style="color:#ae81ff">44</span>:<span style="color:#ae81ff">09</span>] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> on IP <span style="color:#ae81ff">151.80.74.167</span>
</span></span></code></pre></div><ul>
<li>On top of that, I have implemented some higher level commands to gather information from all these platforms with <strong>ip</strong> and <strong>domain</strong>. These commands search for interesting information from almost all the configured plugins:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon domain intel cdnverify<span style="color:#f92672">.</span>net
</span></span><span style="display:flex;"><span><span style="color:#75715e">###################### cdnverify.net ###################</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] Downloading OTX information<span style="color:#f92672">....</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] Downloading Robtex information<span style="color:#f92672">....</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] Downloading Passive Total information<span style="color:#f92672">....</span>
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] Downloading VT information<span style="color:#f92672">....</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-----------------</span> Intelligence Report
</span></span><span style="display:flex;"><span>OTX:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">-</span>Sofacy targeting Romanian Embassy (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span> <span style="color:#f92672">-</span> https:<span style="color:#f92672">//</span>otx<span style="color:#f92672">.</span>alienvault<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>pulse<span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>a7c396f6db26d7636273c44)
</span></span><span style="display:flex;"><span>PT: Nothing found<span style="color:#960050;background-color:#1e0010">!</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-----------------</span> Malware
</span></span><span style="display:flex;"><span>[PT (Emerging Threats (Proofpoint))] <span style="color:#ae81ff">36524</span>c90ca1fac2102e7653dfadb31b2 <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-----------------</span> Urls
</span></span><span style="display:flex;"><span>[VT] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>  <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>[VT] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span>  <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span>
</span></span><span style="display:flex;"><span>[OTX] https:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151.80.74.167</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>
</span></span><span style="display:flex;"><span>[OTX] http:<span style="color:#f92672">//</span>cdnverify<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151.80.74.167</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-----------------</span> Passive DNS
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80.74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span>)(PT)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80.74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>)(VT)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">151.80.74.167</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>)(Robtex)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] <span style="color:#ae81ff">208.91.197.91</span>                            (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">31</span>)(PT)
</span></span></code></pre></div><ul>
<li><strong>Network information</strong> : the commands <strong>ip</strong>, <strong>dns</strong> and <strong>asn</strong> provide basic information about an IP, domain or ASN number (location, dns resolutions or information on the ASN). Nothing fancy but it helps all the time:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon ip info <span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>MaxMind: Located <span style="color:#f92672">in</span> Roubaix, France
</span></span><span style="display:flex;"><span>MaxMind: ASN16276, OVH SAS
</span></span><span style="display:flex;"><span>ASN <span style="color:#ae81ff">16276</span> <span style="color:#f92672">-</span> OVH, FR (range <span style="color:#ae81ff">151.80.0.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Censys:		https:<span style="color:#f92672">//</span>censys<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>ipv4<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>Shodan:		https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>shodan<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>host<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>IP Info:	http:<span style="color:#f92672">//</span>ipinfo<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>BGP HE:		https:<span style="color:#f92672">//</span>bgp<span style="color:#f92672">.</span>he<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>ip<span style="color:#f92672">/</span><span style="color:#ae81ff">151.80.74.167</span>
</span></span><span style="display:flex;"><span>IP Location:	https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>query<span style="color:#f92672">=</span><span style="color:#ae81ff">151.80.74.167</span>
</span></span></code></pre></div><ul>
<li><strong>Social media</strong> : when researching in social media platforms (not sure the API is the best way to do that), I find that saving everything from a social media account quickly is really helpful during an investigation (i.e. before Twitter deletes Russian trolls). Same idea with the <strong>screenshot</strong> command which take a screenshot of a website. For now, only Twitter and Telegram exists:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon twitter <span style="color:#f92672">-</span>s realDonaldTrump <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">@realDonaldTrump</span>
</span></span></code></pre></div><ul>
<li><strong>URL shorteners</strong> : I have also implemented commands for bit.ly and goo.gl url shorteners, the idea is to be able to get as much data as possible from the API:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Ruby" data-lang="Ruby"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon bitly <span style="color:#f92672">-</span>H <span style="color:#ae81ff">2</span>oh6Nrj
</span></span><span style="display:flex;"><span><span style="color:#f92672">--------------------</span> <span style="color:#66d9ef">Bit</span><span style="color:#f92672">.</span>ly <span style="color:#66d9ef">Link</span> infos <span style="color:#f92672">-------------------</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># INFO</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">Link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>oh6Nrj		<span style="color:#e6db74">Metrics</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>oh6Nrj<span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Expanded</span> <span style="color:#e6db74">url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Creation</span> <span style="color:#e6db74">Date</span>: <span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">03</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Aggregate</span> <span style="color:#e6db74">link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">E6V2dF</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> bitly redirect to this url
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LINK  INFO</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">original_url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">canonical_url</span>: <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//ooni</span><span style="color:#f92672">.</span>torproject<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>post<span style="color:#f92672">/</span>mining<span style="color:#f92672">-</span>ooni<span style="color:#f92672">-</span>data<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">html_title</span>: <span style="color:#66d9ef">OONI</span> <span style="color:#f92672">-</span> I have hands, how can I mine <span style="color:#66d9ef">OONI</span> data?
</span></span><span style="display:flex;"><span><span style="color:#e6db74">aggregate_link</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>bit<span style="color:#f92672">.</span>ly<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">E6V2dF</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">indexed</span>: <span style="color:#ae81ff">1519017306</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># USERS</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">User</span>: <span style="color:#ae81ff">2</span>oh6Nrj
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Invalid</span> user!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># CLICKS</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> clicks on this link
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># COUNTRIES</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># REFERRERS</span>
</span></span></code></pre></div><ul>
<li>And then, there are other commands I implemented because I wanted to see what I could get with some APIs. For instance, there is a command for <strong>github</strong> to search in github repos, or <strong>pgp</strong> to search for keys. One command I like particularly is the <strong>cache</strong> command which check for the existence of a web page in different cache platforms.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon cache <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>citizenlab<span style="color:#f92672">.</span>ca<span style="color:#f92672">/</span><span style="color:#ae81ff">2016</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>parliament<span style="color:#f92672">-</span>keyboy<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">Google</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>webcache<span style="color:#f92672">.</span>googleusercontent<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>search?q<span style="color:#f92672">=</span>cache<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#66d9ef">Ahttps</span><span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>strip<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">&amp;</span>num<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&amp;</span>vwsrc<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> (<span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">02</span>:<span style="color:#ae81ff">18</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>)
</span></span><span style="display:flex;"><span><span style="color:#e6db74">Yandex</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>hghltd<span style="color:#f92672">.</span>yandex<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>yandbtm?fmode<span style="color:#f92672">=</span>inject<span style="color:#f92672">&amp;</span>url<span style="color:#f92672">=</span>https<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>tld<span style="color:#f92672">=</span>ru<span style="color:#f92672">&amp;</span>lang<span style="color:#f92672">=</span>en<span style="color:#f92672">&amp;</span>la<span style="color:#f92672">=</span><span style="color:#ae81ff">1518660992</span><span style="color:#f92672">&amp;</span>tm<span style="color:#f92672">=</span><span style="color:#ae81ff">1519019381</span><span style="color:#f92672">&amp;</span>text<span style="color:#f92672">=</span>https<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span>A<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fcitizenlab</span><span style="color:#f92672">.</span>ca<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F2016</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">F11</span><span style="color:#f92672">%</span><span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fparliament</span><span style="color:#f92672">-</span>keyboy<span style="color:#f92672">%</span><span style="color:#ae81ff">2</span>F<span style="color:#f92672">&amp;</span>l10n<span style="color:#f92672">=</span>ru<span style="color:#f92672">&amp;</span>mime<span style="color:#f92672">=</span>html<span style="color:#f92672">&amp;</span>sign<span style="color:#f92672">=</span>ef543d285bc848b89e51b5a654f7f6aa<span style="color:#f92672">&amp;</span>keyno<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Archive</span><span style="color:#f92672">.</span>is: <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">FOUND</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Archive</span><span style="color:#f92672">.</span>org: <span style="color:#66d9ef">FOUND</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span><span style="color:#ae81ff">2018</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span> <span style="color:#ae81ff">10</span>:<span style="color:#ae81ff">05</span>:<span style="color:#ae81ff">03</span>: <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>web<span style="color:#f92672">.</span>archive<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>web<span style="color:#f92672">/</span><span style="color:#ae81ff">20180203100503</span><span style="color:#f92672">/</span><span style="color:#e6db74">https</span>:<span style="color:#e6db74">//</span>citizenlab<span style="color:#f92672">.</span>ca<span style="color:#f92672">/</span><span style="color:#ae81ff">2016</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>parliament<span style="color:#f92672">-</span>keyboy<span style="color:#f92672">/</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">Bing</span>: <span style="color:#66d9ef">FOUND</span> <span style="color:#e6db74">http</span>:<span style="color:#e6db74">//</span>cc<span style="color:#f92672">.</span>bingj<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span>cache<span style="color:#f92672">.</span>aspx?d<span style="color:#f92672">=</span><span style="color:#ae81ff">5023416941477933</span><span style="color:#f92672">&amp;</span>w<span style="color:#f92672">=</span>p_fS69zzGSfsYoCCryqQAHXJ09tpPdBB (<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span> <span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>)
</span></span></code></pre></div><ul>
<li>Last but not least, the <strong>help</strong> commands gives (hopefully) detailed information on any command :</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon help ip
</span></span><span style="display:flex;"><span><span style="color:#75715e"># IP</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Gathers information on an IP address
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Get information on an IP:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>harpoon ip info <span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>MaxMind: Located <span style="color:#f92672">in</span> <span style="color:#66d9ef">None</span>, United States
</span></span><span style="display:flex;"><span>MaxMind: ASN21928, T<span style="color:#f92672">-</span>Mobile USA, Inc<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>ASN <span style="color:#ae81ff">21928</span> <span style="color:#f92672">-</span> T<span style="color:#f92672">-</span>MOBILE<span style="color:#f92672">-</span>AS21928 <span style="color:#f92672">-</span> T<span style="color:#f92672">-</span>Mobile USA, Inc<span style="color:#f92672">.</span>, US (range <span style="color:#ae81ff">172.32.0.0</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Censys:     https:<span style="color:#f92672">//</span>censys<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>ipv4<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>Shodan:     https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>shodan<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span>host<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>IP Info:    http:<span style="color:#f92672">//</span>ipinfo<span style="color:#f92672">.</span>io<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>BGP HE:     https:<span style="color:#f92672">//</span>bgp<span style="color:#f92672">.</span>he<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span>ip<span style="color:#f92672">/</span><span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>IP Location:    https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>iplocation<span style="color:#f92672">.</span>net<span style="color:#f92672">/</span><span style="color:#960050;background-color:#1e0010">?</span>query<span style="color:#f92672">=</span><span style="color:#ae81ff">172.34.127.2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">*</span> Get intelligence information on an IP: harpoon ip intel IP
</span></span></code></pre></div><h2 id="harpoontools">harpoontools<a class="anchor" href="#harpoontools">#</a></h2>
<p>At some point, I got sick of using <code>harpoon XXX</code> for some commands I was using all the time. So I created a repository <a href="https://github.com/Te-k/harpoontools" target="_blank">harpoontools</a> that installs commands using Harpoon features. You can install it through <code>pip install git+ssh://git@github.com/Te-k/harpoontools</code></p>
<p>For now I have only implemented <strong>ipinfo</strong>, <strong>asninfo</strong> and <strong>dns</strong> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> cat ips <span style="color:#f92672">|</span> ipinfo
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">66.249.66.6</span> ; ASN15169 ; Google LLC ; Mountain View ; United States
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">184.105.139.116</span> ; ASN6939 ; Hurricane Electric, Inc<span style="color:#f92672">.</span> ; Fremont ; United States
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">184.105.247.206</span> ; ASN6939 ; Hurricane Electric, Inc<span style="color:#f92672">.</span> ; Salt Lake City ; United States
</span></span></code></pre></div><h2 id="example">Example<a class="anchor" href="#example">#</a></h2>
<p>It is hard to give a real-life example of Harpoon as it is helpful for different types of investigations, but let&rsquo;s try with the recent Palo Alto report about <a href="https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/" target="_blank">Quasar RAT</a> and focus on the domain <code>akamaicdn[.]ru</code>.</p>
<p>First let&rsquo;s check what is the actual DNS resolution :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon  dns akamaicdn[<span style="color:#f92672">.</span>]ru
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A</span>
</span></span><span style="display:flex;"><span>No A entry
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AAAA</span>
</span></span><span style="display:flex;"><span>No AAAA entry configured
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># NS</span>
</span></span><span style="display:flex;"><span>ns2<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">176.99.13.12</span> <span style="color:#f92672">-</span> ASN197695 Domain names registrar REG<span style="color:#f92672">.</span>RU, Ltd <span style="color:#f92672">-</span> <span style="color:#66d9ef">None</span> Russia
</span></span><span style="display:flex;"><span>ns1<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">176.99.13.15</span> <span style="color:#f92672">-</span> ASN197695 Domain names registrar REG<span style="color:#f92672">.</span>RU, Ltd <span style="color:#f92672">-</span> <span style="color:#66d9ef">None</span> Russia
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># MX:</span>
</span></span><span style="display:flex;"><span>No MX entry configured
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SOA</span>
</span></span><span style="display:flex;"><span>NS: ns1<span style="color:#f92672">.</span>reg<span style="color:#f92672">.</span>ru<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>Owner: hostmaster<span style="color:#f92672">.</span>ns1<span style="color:#a6e22e">@reg.ru</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># TXT:</span>
</span></span><span style="display:flex;"><span>No TXT entry configured
</span></span></code></pre></div><p>No A entry, I guess the operation stopped. Let&rsquo;s see if we can get any older IP with robtex:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon robtex domain akamaicdn<span style="color:#f92672">.</span>ru
</span></span><span style="display:flex;"><span>Passive DNS info:
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] A	<span style="color:#ae81ff">194.85.61.76</span>	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] NS	ns1<span style="color:#f92672">.</span>expired<span style="color:#f92672">.</span>r01<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] A	<span style="color:#ae81ff">109.70.26.37</span>	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] NS	ns2<span style="color:#f92672">.</span>expired<span style="color:#f92672">.</span>r01<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">+</span>] MX	nomail<span style="color:#f92672">.</span>nic<span style="color:#f92672">.</span>ru	(<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span> <span style="color:#f92672">-&gt;</span> <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T14:<span style="color:#ae81ff">55</span>:<span style="color:#ae81ff">12</span>)
</span></span></code></pre></div><p>Let&rsquo;s check where these IPs are:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> ipinfo <span style="color:#ae81ff">194.85.61.76</span> <span style="color:#ae81ff">109.70.26.37</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">194.85.61.76</span> ; ASN48287 ; Jsc ru<span style="color:#f92672">-</span>center ; Moscow ; Russia
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">109.70.26.37</span> ; ASN48287 ; Jsc ru<span style="color:#f92672">-</span>center ; <span style="color:#66d9ef">None</span> ; Russia
</span></span></code></pre></div><p>We can check if certificates were created for this domain with crt.sh :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon crtsh <span style="color:#f92672">-</span>d akamaicdn<span style="color:#f92672">.</span>ru
</span></span><span style="display:flex;"><span>Certificates
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	B05CB0F1425FBFA7E9407C777C6B4DC0E3F7F1B6
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">7</span>B9F1F8A2F7211C332C60EBFDB6CF739DF7D2A3A
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">22</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	D372B140802DA627BD0745B447A9E3A48B2FBD15
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">01</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">07</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">3868</span>C466BC8D131B2EB6B65CD7B20E7FFB255C51
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	BBEBA7914A4287C8BDDCD81510A327D33E6476F5
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	F0F0A0D02A8E16B3A261382D75B8C96393A16264
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">27</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	E285191C82EA0F5FD23EF4688A62E5772F4584D4
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">7</span>F40B0D369700BFC27C2AD2EB858D8DF4955624D
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">28</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	EDE5454F23BBC7BFBA17F2E293D7FBDD1266B260
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">68</span>D504FAEB6AF1DDA50062B16CBFB46AAD490171
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2</span>F2231766F8432343B579DB21ECF829CB171E481
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">23</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	B11FCBEAD0A2D174C661D8095A0693955FC62A99
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span><span style="color:#f92672">-</span><span style="color:#ae81ff">19</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">62578</span>BABE0AFFE15ABE3FBD68A6EE8EF76AB556A
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">5630</span>B82083D14B0D5202FEAC7566971ECA41BBDC
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">20</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	D5A7B4CC6DF2340E8F547E3CC0A17163A81FD51A
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">500</span>DA087F038AEB5A37D9F60638332DBA8368BA2
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">05</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">06</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	C54AEC0DA67F1B12A134C6B997EE93DFA0EEE4F2
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">04</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	E746CD3581198237D3D26F8A80FF71BAD88D1544
</span></span><span style="display:flex;"><span>sni11878<span style="color:#f92672">.</span>cloudflaressl<span style="color:#f92672">.</span>com	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">18</span>T00:<span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">08</span><span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>T23:<span style="color:#ae81ff">59</span>:<span style="color:#ae81ff">59</span><span style="color:#f92672">+</span><span style="color:#ae81ff">00</span>:<span style="color:#ae81ff">00</span>	<span style="color:#ae81ff">451608653</span>F741F079CC52569F7FAFB8C5B1F8855
</span></span></code></pre></div><p>So apparently they used Cloudfare to host this domain. We likely have a partial view of passive DNS information due to Robtex limitations, but let&rsquo;s check if OTX knows anything about the IP address <code>194.85.61.76</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">$</span> harpoon otx <span style="color:#f92672">-</span>s <span style="color:#ae81ff">194.85.61.76</span>
</span></span><span style="display:flex;"><span>No analysis on this file
</span></span><span style="display:flex;"><span>Listed <span style="color:#f92672">in</span> <span style="color:#ae81ff">5</span> pulses
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>BadRabbit<span style="color:#f92672">-</span>Ransomware <span style="color:#f92672">-</span> A Modified Version of NotPetya
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2017</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T17:<span style="color:#ae81ff">58</span>:<span style="color:#ae81ff">14.502000</span>
</span></span><span style="display:flex;"><span>		References:
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">59</span>fcae36f0c4a216de3560ea
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>Blueliv Chasing cybercrime: Vawtrak v2 IOCs
</span></span><span style="display:flex;"><span>		Vawtrak <span style="color:#f92672">is</span> a serious threat <span style="color:#66d9ef">for</span> the finance sector <span style="color:#f92672">and</span> <span style="color:#f92672">is</span> predicted to be the next major banking Trojan<span style="color:#f92672">.</span> Blueliv<span style="color:#f92672">&amp;</span><span style="color:#75715e">#39;s investigation into Vawtrak v2 has revealed new information to piece together a more complete view of the Vawtrak banking Trojan and the cybercriminal groups behind it than we&amp;#39;ve seen before. The report also provides real infection data and Indicators of Compromise (IoCs) that readers can input into their existing security solutions to enhance their protection. Here is the full list of Vawtrak and Moskalvzapoe IOCs discovered as part of the Blueliv analysis.</span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">09</span><span style="color:#f92672">-</span><span style="color:#ae81ff">12</span>T17:<span style="color:#ae81ff">36</span>:<span style="color:#ae81ff">18.734000</span>
</span></span><span style="display:flex;"><span>		References: https:<span style="color:#f92672">//</span>community<span style="color:#f92672">.</span>blueliv<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#75715e">#/s/57d6d33d82df41127d7a6ca4, https://www.sophos.com/en-us/medialibrary/PDFs/technical%20papers/sophos-vawtrak-v2-sahin-wyke.pdf?la=en</span>
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">57</span>d6e794aa954c115b68a85f
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>Ursnif CnC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>T00:<span style="color:#ae81ff">35</span>:<span style="color:#ae81ff">04.809000</span>
</span></span><span style="display:flex;"><span>		References:
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">56</span>c3c03867db8c12501745c6
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>Angler EK Network IOC
</span></span><span style="display:flex;"><span>		Angler EK Network IOC observed <span style="color:#f92672">in</span> the past year<span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2016</span><span style="color:#f92672">-</span><span style="color:#ae81ff">02</span><span style="color:#f92672">-</span><span style="color:#ae81ff">17</span>T15:<span style="color:#ae81ff">25</span>:<span style="color:#ae81ff">35.814000</span>
</span></span><span style="display:flex;"><span>		References:
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">56</span>c490f067db8c1250175b9d
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">-</span>Chinese Government Website Compromised, Leads to Angler
</span></span><span style="display:flex;"><span>		Despite a recent takedown targeting the Angler Exploit Kit (EK), it<span style="color:#e6db74">&#39;s back to business as usual for kit operators. On 30-October-2015, ThreatLabZ noticed a compromised Chinese government website that led to the Angler Exploit Kit with an end payload of Cryptowall 3.0. This compromise does not appear targeted and the compromised site was cleaned up within 24 hours. We have noticed some recent changes to Angler, as well as the inclusion of newer Flash exploits. A set of indicators for this compromise is at the end of this post.</span>
</span></span><span style="display:flex;"><span>		Created: <span style="color:#ae81ff">2015</span><span style="color:#f92672">-</span><span style="color:#ae81ff">11</span><span style="color:#f92672">-</span><span style="color:#ae81ff">03</span>T19:<span style="color:#ae81ff">21</span>:<span style="color:#ae81ff">57.947000</span>
</span></span><span style="display:flex;"><span>		References: http:<span style="color:#f92672">//</span>research<span style="color:#f92672">.</span>zscaler<span style="color:#f92672">.</span>com<span style="color:#f92672">/</span><span style="color:#ae81ff">2015</span><span style="color:#f92672">/</span><span style="color:#ae81ff">11</span><span style="color:#f92672">/</span>chinese<span style="color:#f92672">-</span>government<span style="color:#f92672">-</span>website<span style="color:#f92672">-</span>compromised<span style="color:#f92672">.</span>html
</span></span><span style="display:flex;"><span>		id: <span style="color:#ae81ff">563909554637</span>f2388aaf2311
</span></span><span style="display:flex;"><span>Passive DNS:
</span></span><span style="display:flex;"><span>[SNIP]
</span></span></code></pre></div><h2 id="create-a-new-command">Create a new command<a class="anchor" href="#create-a-new-command">#</a></h2>
<p>Harpoon is a plugin-based tool, so it is pretty easy to add new features just by creating new plugins. To do so, you need to create a new file in harpoon/commands and implement a class inheriting the Command class. Let&rsquo;s say we would like to implement a ping command (which would not be really helpful), we could create the following <code>ping.py</code> file :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> harpoon.commands.base <span style="color:#f92672">import</span> Command
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CommandPing</span>(Command):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # Ping
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Here put the help in markdown format
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ping&#34;</span>
</span></span><span style="display:flex;"><span>    decription <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Ping command&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add_arguments</span>(self, parser):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Here add arguments to the parser (which is an argparse parser)</span>
</span></span><span style="display:flex;"><span>        parser<span style="color:#f92672">.</span>add_arguments(<span style="color:#e6db74">&#39;IP&#39;</span>, help<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;IP to ping&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># It is nice to save the parser to call help later if needed</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>parser <span style="color:#f92672">=</span> parser
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self, conf, args, plugins):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># here, implements the actual task</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># args contains the arguments received from the parser</span>
</span></span><span style="display:flex;"><span>        os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;ping -c 1 &#34;</span> <span style="color:#f92672">+</span> args<span style="color:#f92672">.</span>IP)
</span></span></code></pre></div><p>That&rsquo;s all folks, feel free to play with it and open <a href="https://github.com/Te-k/harpoon/issues" target="_blank">issues</a> and submit <a href="https://github.com/Te-k/harpoon/pulls" target="_blank">pull requests</a>. You can also ping me on <a href="https://twitter.com/tenacioustek" target="_blank">Twitter</a>.</p>
<p>Thanks to <a href="https://twitter.com/0xStarcat" target="_blank">Starcat</a> for the feedback on the blog post! Most of this text was written while listening to Amanda Palmer singing <a href="https://www.youtube.com/watch?v=uAk93YZgTts" target="_blank">No Surprises</a>.</p>


              
          </article>
          

<ul class="tags__list">
    
    <li class="tag__item">
        <a class="tag__link" href="https://maynier.eu/tags/osint/">osint</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://maynier.eu/tags/tools/">tools</a>
    </li></ul>

 <div class="pagination">
  
    <a class="pagination__item" href="https://maynier.eu/blog/2018/02/04/another-pe-tool/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">Another PE tool</span>
    </a>
  

  
    <a class="pagination__item" href="https://maynier.eu/blog/2019/01/05/2019-osint-guide/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >2019 OSINT Guide</a>
    </a>
  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
    
    
  
    
    
      <a class="social-icons__icon" title="Mastodon"
         style="background-image: url(/images/social/mastodon.svg)"
         href="https://todon.eu/@tek"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
      <a class="social-icons__icon" title="BlueSky"
         style="background-image: url(/images/social/bluesky.svg)"
         href="https://bsky.app/profile/tek.randhome.io"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
      <a class="social-icons__icon" title="GitHub"
         style="background-image: url(/images/social/github.svg)"
         href="https://github.com/Te-k"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
      <a class="social-icons__icon" title="Email"
         style="background-image: url(/images/social/email.svg)"
         href="mailto:etienne@maynier.eu"
         target="_blank" rel="noopener">
      </a>
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
</div>

            <p> 2025</p>
          </footer>
          </div>
      </div>
      
    </div>


  </main>

   

  
  <script src="/js/index.min.301a8b0870381bf76b3b5182e8966d363a0474281183439beb024d8b8228fc66.js" integrity="sha256-MBqLCHA4G/drO1GC6JZtNjoEdCgRg0Ob6wJNi4Io/GY=" crossorigin="anonymous"></script>
  
  


</body>

</html>
